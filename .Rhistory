mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & nrow != 73)))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73)))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73)))
df_all%>%
group_by(year,inst)%>%
summarize(n=n())%>%
kable()
library*kable
library(kable0
)
library(kable)
library(tidyr)
df_all%>%
group_by(year,inst)%>%
summarize(n=n())%>%
kable()
######################################################################
# Set directory
######################################################################
setwd("/Users/fumiyau/Dropbox (Princeton)/09.CollegeMajor/1.Data/NameEdited/")
library(knitr)
df_all%>%
group_by(year,inst)%>%
summarize(n=n())%>%
kable()
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #13962 to 13890
table(df_all$year, df_all$inst)
df_all
df_all%>%
mutate(n=1)
group_by(year,inst)%>%
summarize(n=sum(n))%>%
kable()
df_all%>%
mutate(n=1)
group_by(year,inst)%>%
summarize(n=sum(n))
df_all%>%
mutate(n=1) %>%
group_by(year,inst)%>%
summarize(n=sum(n))
df_all%>%
mutate(n=1) %>%
group_by(year,inst)%>%
summarize(test=sum(n))
write.csv(df_all, "df_all.csv")
read_excel("1994.xls", sheet = 1,skip=4)
read_excel("1994.xls", sheet = 2,skip=4)
read_excel("1994.xls", sheet = 3,skip=4)
read_excel("1994.xls", sheet = 4,skip=4)
View(All_1986)
df_all1 <- do.call(bind_rows, c(All_1986,All_2015))
View(df_all1)
df1994 <- read.xls("1994.xls", sheet = 2, fileEncoding="utf8")
View(df1994)
df1994 <- read.xls("1994.xls", sheet = 4, fileEncoding="utf8")
df1994 <- read.xls("1994.xls", sheet = 4, fileEncoding="utf8")%>%
filter(X.1  != "" & X.4 != "" )%>%
mutate(year = 1994,
X.6=X.5,
X.5=X.4,
X.2=X.1) %>%
dplyr::select(X.2, X.5,X.6,year)
df_all1 <- do.call(bind_rows, c(All_1986,All_2015)) %>%
filter(`...1`!= "" & 男 != "" )
df_all1 <- do.call(bind_rows, c(All_1986,All_2015)) %>%
filter(`...1`!= "" )
View(df_all2)
df_all2 <- do.call(bind_rows, All_1975) %>%
filter(`...1`!= "" )
df_1999 <- do.call(bind_rows, All_1999)
df_1999 <- do.call(bind_rows, All_1999) %>%
filter(`...1`!= "" )
df_1999 <- do.call(bind_rows, All_1999)
View(df_1999)
View(df_1985)
df_all1 <- do.call(bind_rows, c(All_1986,All_2015)) %>%
filter(`...1`!= "" )
df_1999 <- do.call(bind_rows, All_1999) %>%
filter(`...1`!= "" )
df_1985 <- do.call(bind_rows, All_1985)
df_all2 <- do.call(bind_rows, All_1975) %>%
filter(`...1`!= "" )
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73)))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70)))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>% # 13948 to 13932
write.csv(df_all, "df_all.csv")
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) # 13948 to 13932
write.csv(df_all, "df_all.csv")
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(-year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) # 13948 to 13932
write.csv(df_all, "df_all.csv")
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(-year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,men=`男`,women=`女`,type=inst)
write.csv(df_all, "df_all.csv")
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(-year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst)
write.csv(df_all, "df_all.csv")
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(-year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutaet(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(-year) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutate(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women))
write.csv(df_all, "df_all.csv")
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year, decreasing = TRUE) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutate(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women))
write.csv(df_all, "df_all.csv")
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year, decreasing = TRUE) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutate(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women),
mutate(num=data.table::rowid(inst)))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year, decreasing = TRUE) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutate(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women),
num=data.table::rowid(inst))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year, decreasing = TRUE) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutate(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women),
num=data.table::rowid(type))
df_all
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year, decreasing = TRUE) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutate(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women),
num=data.table::rowid(type))
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year, decreasing = TRUE) %>%
arrange(inst) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutate(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women))
write.csv(df_all, "df_all.csv")
#=====================================================================
# 2020/06/29
# College major segregation
# Fumiya Uchikoshi, uchikoshi@princeton.edu
# Ryota Mugiyama
# Megumi Oguro
#=====================================================================
######################################################################
# Loading packages
######################################################################
library(gdata)
library(tidyverse)
library(dplyr)
library(ggthemes)
library(knitr)
######################################################################
# Set directory
######################################################################
setwd("/Users/fumiyau/Dropbox (Princeton)/09.CollegeMajor/CollegeMajorSegregation/2.Data/NameEdited/")
######################################################################
# lapply for 1986-2019 (except for 1999)
######################################################################
All_2015 <- lapply(1:4,function(i){
lapply(2015:2019,function(j){
read_excel(paste(j,".xlsx",sep=""), sheet = i,skip=4) %>%
dplyr::select(2,5,6) %>%
mutate(year = j,
inst = i)
})
})
All_1986 <- lapply(1:4,function(i){
lapply(c(1986:1998,2000:2014),function(j){
read_excel(paste(j,".xls",sep=""), sheet = i,skip=4) %>%
dplyr::select(2,5,6) %>%
mutate(year = j,
inst = i,
`男...5`=as.numeric(paste(男...5)),
`女...6`=as.numeric(paste(女...6)))
})
})
df_all1 <- do.call(bind_rows, c(All_1986,All_2015)) %>%
filter(`...1`!= "" )
######################################################################
# lapply for 1999 and 1985
######################################################################
All_1999 <- lapply(1:4,function(i){
read_excel(paste("1999.xls",sep=""), sheet = i,skip=4) %>%
dplyr::select(2,4,5) %>%
mutate(year = 1999,
inst = i,
`男...4`=as.numeric(paste(男...4)),
`女...5`=as.numeric(paste(女...5)))
})
All_1985 <- lapply(1:4,function(i){
read_excel(paste("1985.xls",sep=""), sheet = i,skip=3) %>%
dplyr::select(1,3,4) %>%
mutate(year = 1985,
inst = i,
`男...3`=as.numeric(paste(男...3)),
`女...4`=as.numeric(paste(女...4)))
})
df_1999 <- do.call(bind_rows, All_1999) %>%
filter(`...1`!= "" )
df_1985 <- do.call(bind_rows, All_1985)
######################################################################
# lapply for 1975-1984
######################################################################
All_1975 <- lapply(1:4,function(i){
lapply(c(1975:1984),function(j){
read_excel(paste(j,".xls",sep=""), sheet = i,skip=4) %>%
dplyr::select(1,3,4) %>%
mutate(year = j,
inst = i,
`男...3`=as.numeric(paste(男...3)),
`女...4`=as.numeric(paste(女...4)))
})
})
df_all2 <- do.call(bind_rows, All_1975) %>%
filter(`...1`!= "" )
######################################################################
# Combine
######################################################################
df_all <- bind_rows(df_all2,df_1985,df_1999,df_all1) %>%
arrange(year, decreasing = TRUE) %>%
arrange(inst) %>%
mutate(major=`...1`) %>%
filter(major != "人文科学" & major != "社会科学" & major != "理学" & major != "工学" &
major != "保健" & major != "商船" & major != "家政" &
major != "教育" & major != "芸術" ) %>%
filter(!grepl("この表", major)) %>%
mutate(num=data.table::rowid(year,inst)) %>%
filter((year >= 1984 | (year < 1984 & num != 31 & num != 73))) %>% #14020 to 13948
filter((year >= 1986 | year <= 1983 | (year >= 1984 & year <= 1985 & num != 31 & num != 70))) %>%  # 13948 to 13932
dplyr::select(major,year,men=`男`,women=`女`,type=inst) %>%
mutate(men=if_else(is.na(men)==TRUE,0,men),
women=if_else(is.na(women)==TRUE,0,women))
write.csv(df_all, "df_all.csv")
library(dplyr)
library(ggplot2)
library(ggthemes)
library(readxl)
library(foreach)
######################################################################
# Change Working Directorys
######################################################################
setwd("/Users/fumiyau/Dropbox (Princeton)/18.Covid19_CrossNational")
######################################################################
# Data create
######################################################################
list <- excel_sheets("STMFinput/stmf.xlsx")[c(2:21)]
All <- lapply(list,function(i){
read_excel("STMFinput/stmf.xlsx",sheet = i,skip=2) %>%
dplyr::select(Country,Year,Week,Sex,r0=`0-14...11`,r15=`15-64...12`,r65=`65-74...13`,
r75=`75-84...14`,r85=`85+...15`,rt=`Total...16`)
})
df_all <- do.call(bind_rows, All) %>%
mutate(Year=as.character(Year),
rt=rt*1000,
r85=r85*1000,
r75=r75*1000,
r15=r15*1000) %>%
filter(Country != "ISL" & Year>2014)  #ISL's mortality looks messy
df_20162019 <- df_all %>%
filter(Year != "2020") %>%
group_by(Country, Week, Sex) %>%
summarise_at(c("r0", "r15","r65","r75","r85","rt"),mean) %>%
mutate(Year="2015-2019")
df <- df_all %>%
filter(Year == "2020") %>%
bind_rows(df_20162019) %>%
mutate(  excess85=r85/r15,
excess75=r75/r15)
dfb <- df %>%
filter(Sex == "b")
dff <- df %>%
filter(Sex == "f")
dfm <- df %>%
filter(Sex == "m")
######################################################################
# Data viz
######################################################################
cbp1 <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7")
plot_excess85b <- ggplot(dfb, mapping = aes(x=Week,y=excess85,group=Year,color=Year,shape=Year))+
geom_line()+facet_wrap(~Country)+xlab("Week")+ylab("Ratio of mortality rate")+ylim(0,250)+
theme_few() +theme(legend.title=element_blank(), legend.position = "bottom")+
scale_colour_manual(values=cbp1)+
ggtitle("Weekly excess mortality ratios (85+ relative to 15-64, both sexes)")
ggsave(plot_excess85b,height=8,width=12,dpi=200, filename="2.Figures/excess85b.pdf",  family = "Helvetica")
######################################################################
# Data viz
######################################################################
setwd("~/Covid19_CrossNational_Elderly")
######################################################################
# Data viz
######################################################################
setwd("./Covid19_CrossNational_Elderly")
######################################################################
# Change Working Directorys
######################################################################
setwd("/Users/fumiyau/Dropbox (Princeton)/18.Covid19_CrossNational/")
######################################################################
# Data viz
######################################################################
setwd("./Covid19_CrossNational_Elderly")
######################################################################
# Data viz
######################################################################
setwd("~/Covid19_CrossNational_Elderly")
setwd("/Users/fumiyau/Dropbox (Princeton)/18.Covid19_CrossNational/Covid19_CrossNational_Elderly")
cbp1 <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7")
plot_excess85b <- ggplot(dfb, mapping = aes(x=Week,y=excess85,group=Year,color=Year,shape=Year))+
geom_line()+facet_wrap(~Country)+xlab("Week")+ylab("Ratio of mortality rate")+ylim(0,250)+
theme_few() +theme(legend.title=element_blank(), legend.position = "bottom")+
scale_colour_manual(values=cbp1)+
ggtitle("Weekly excess mortality ratios (85+ relative to 15-64, both sexes)")
ggsave(plot_excess85b,height=8,width=12,dpi=200, filename="Figures/excess85b.pdf",  family = "Helvetica")
setwd("/Users/fumiyau/Dropbox (Princeton)/18.Covid19_CrossNational/Covid19_CrossNational_Elderly")
plot_excess85b <- ggplot(dfb, mapping = aes(x=Week,y=excess85,group=Year,color=Year,shape=Year))+
geom_line()+facet_wrap(~Country)+xlab("Week")+ylab("Ratio of mortality rate")+ylim(0,250)+
theme_few() +theme(legend.title=element_blank(), legend.position = "bottom")+
scale_colour_manual(values=cbp1)+
ggtitle("Weekly excess mortality ratios (85+ relative to 15-64, both sexes)")
ggsave(plot_excess85b,height=8,width=12,dpi=200, filename="Figures/excess85b.pdf",  family = "Helvetica")
plot_excess85b <- ggplot(dfb, mapping = aes(x=Week,y=excess85,group=Year,color=Year,shape=Year))+
geom_line()+facet_wrap(~Country)+xlab("Week")+ylab("Ratio of mortality rate")+ylim(0,250)+
theme_few() +theme(legend.title=element_blank(), legend.position = "bottom")+
scale_colour_manual(values=cbp1)+
ggtitle("Weekly excess mortality ratios (85+ relative to 15-64, both sexes)")
plot_excess85b
ggsave(plot_excess85b,height=8,width=12,dpi=200, filename="Figures/excess85b.pdf",  family = "Helvetica")
ggsave(plot_excess85b,height=8,width=12,dpi=200, filename="Figures/excess85b.png",  family = "Helvetica")
ggsave(plot_excess85b,height=6,width=9,dpi=200, filename="Figures/excess85b.png",  family = "Helvetica")
